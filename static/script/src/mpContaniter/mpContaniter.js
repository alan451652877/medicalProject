// Generated by CoffeeScript 1.10.0
(function() {
  var bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  define(['doT!../views/main/doctorInfo', 'doT!../views/log/login', 'doT!../views/log/register', 'mpContaniterModel', 'aboutUsCtrl', 'desPartnersCtrl', 'USAExpertsCtrl', 'ui.dialog'], function(doctorInfo, loginTmp, registerTmp, mpContaniterModel, aboutUsCtrl, desPartnersCtrl, USAExpertsCtrl) {
    var mpContaniter;
    return mpContaniter = (function() {
      var currentClass, doctorUrlPanel, documentPanel, mainBody, mainHeader, mainPanel, menuListPanel, table_head;

      mainPanel = null;

      mainHeader = null;

      mainBody = null;

      doctorUrlPanel = null;

      menuListPanel = null;

      documentPanel = null;

      currentClass = "";

      table_head = null;

      function mpContaniter() {
        this.bindEvent = bind(this.bindEvent, this);
        var doctorData, doctorUrlList, i, len, urlPanel;
        mainPanel = $('.mainPanel');
        mainBody = mainPanel.find('.mainBody');
        table_head = mainBody.find(".table_head");
        currentClass = table_head.find("span:eq(0)").data("id") || "XXG";
        mainHeader = mainPanel.find('.headerPanel');
        doctorUrlPanel = mainBody.find('.doctorListPanel');
        documentPanel = mainBody.find(".document_context");
        menuListPanel = mainPanel.find('.menuList');
        this.mpContaniterModel = new mpContaniterModel();
        doctorUrlList = this.mpContaniterModel.getDoctorUrlList();
        urlPanel = '';
        for (i = 0, len = doctorUrlList.length; i < len; i++) {
          doctorData = doctorUrlList[i];
          urlPanel += "<div id=" + doctorData.id + " class=\"doctorPic\">\n<img src=" + IMG_BASEPATH + doctorData.url + ">\n</div>";
        }
        doctorUrlPanel.find('.doctorListScroll').append(urlPanel);
        this.bindEvent();
      }

      mpContaniter.prototype.bindEvent = function() {
        var changeDotImg, doctorPicIndex;
        mainHeader.on('click', '.login', (function(_this) {
          return function(event) {
            var loginPanel;
            return loginPanel = $(loginTmp('')).dialog({
              title: '登陆',
              modal: true,
              width: 300,
              height: 250,
              resizable: false
            }).on('click', '.login', function(event) {
              var loginObj;
              loginObj = {};
              return loginObj = _this.mpContaniterModel.login(loginPanel, loginObj);
            });
          };
        })(this)).on('click', '.register', (function(_this) {
          return function(event) {
            var registerPanel;
            return registerPanel = $(registerTmp('')).dialog({
              title: '注册',
              modal: true,
              width: 400,
              height: 400,
              resizable: false
            }).on('click', '.register', function(event) {
              var registerObj;
              registerObj = {};
              return registerObj = _this.mpContaniterModel.register(registerPanel, registerObj);
            });
          };
        })(this)).on('click', '.aboutUs', (function(_this) {
          return function(event) {
            return new aboutUsCtrl(mainBody);
          };
        })(this)).on('click', '.DesPartners', (function(_this) {
          return function(event) {
            return new desPartnersCtrl(mainBody);
          };
        })(this)).on('click', '.USAExperts', (function(_this) {
          return function(event) {
            return new USAExpertsCtrl(mainBody);
          };
        })(this));
        doctorUrlPanel.on('click', '.doctorPic img', (function(_this) {
          return function(event) {
            var doctorPic, id;
            doctorPic = $(event.currentTarget);
            id = doctorPic.attr('id');
            return $(doctorInfo({
              id: id
            })).dialog({
              title: '医生信息',
              modal: true,
              width: 300,
              height: 250,
              resizable: false
            });
          };
        })(this));
        mainBody.on("click", ".courseware", (function(_this) {
          return function(event) {
            doctorUrlPanel.hide();
            documentPanel.show();
            return _this.mpContaniterModel.getDocumentList($(".file_classification").val(), function(responseMsg) {
              return console.log(responseMsg);
            });
          };
        })(this)).on("click", ".change_classification", (function(_this) {
          return function(event) {
            _this = $(event.currentTarget);
            return $(".file_classification").val(_this.data("id"));
          };
        })(this));
        doctorPicIndex = 1;
        return changeDotImg = window.setInterval((function(_this) {
          return function() {
            var marginLeft;
            if (doctorUrlPanel.length === 0) {
              window.clearInterval(changeDotImg);
            }
            doctorPicIndex++;
            marginLeft = (doctorPicIndex - 1) * 115;
            doctorUrlPanel.find('.doctorPic').first().css('margin-left', '-' + marginLeft + 'px');
            if (doctorPicIndex === 3) {
              return doctorPicIndex = 0;
            }
          };
        })(this), '2000');
      };

      return mpContaniter;

    })();
  });

}).call(this);
