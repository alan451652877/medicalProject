// Generated by CoffeeScript 1.10.0
(function() {
  var bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  define(['doT!../views/main/doctorInfo', 'doT!../views/log/login', 'mpContaniterModel', 'aboutUsCtrl', 'desPartnersCtrl', 'ui.dialog'], function(doctorInfo, loginTmp, mpContaniterModel, aboutUsCtrl, desPartnersCtrl) {
    var mpContaniter;
    return mpContaniter = (function() {
      var doctorUrlPanel, mainBody, mainHeader, mainPanel, menuListPanel;

      mainPanel = null;

      mainHeader = null;

      mainBody = null;

      doctorUrlPanel = null;

      menuListPanel = null;

      function mpContaniter() {
        this.bindEvent = bind(this.bindEvent, this);
        var doctorData, doctorUrlList, i, len, urlPanel;
        mainPanel = $('.mainPanel');
        mainBody = mainPanel.find('.mainBody');
        mainHeader = mainPanel.find('.headerPanel');
        doctorUrlPanel = mainBody.find('.doctorListPanel');
        menuListPanel = mainPanel.find('.menuList');
        this.mpContaniterModel = new mpContaniterModel();
        doctorUrlList = this.mpContaniterModel.getDoctorUrlList();
        urlPanel = '';
        for (i = 0, len = doctorUrlList.length; i < len; i++) {
          doctorData = doctorUrlList[i];
          urlPanel += "<div id=" + doctorData.id + " class=\"doctorPic\">\n<img src=" + BASEPATH + "/static/img" + doctorData.url + ">\n</div>";
        }
        doctorUrlPanel.find('.doctorListScroll').append(urlPanel);
        this.bindEvent();
      }

      mpContaniter.prototype.bindEvent = function() {
        var changeDotImg, doctorPicIndex;
        mainHeader.on('click', '.login', (function(_this) {
          return function(event) {
            var loginPanel;
            return loginPanel = $(loginTmp('')).dialog({
              title: '登陆',
              modal: true,
              width: 300,
              height: 250,
              resizable: false
            }).on('click', '.login', function(event) {
              var loginObj;
              loginObj = {};
              return loginObj = _this.mpContaniterModel.login(loginPanel, loginObj);
            });
          };
        })(this)).on('click', '.aboutUs', (function(_this) {
          return function(event) {
            return new aboutUsCtrl(mainBody);
          };
        })(this)).on('click', '.DesPartners', (function(_this) {
          return function(event) {
            return new desPartnersCtrl(mainBody);
          };
        })(this));
        doctorUrlPanel.on('click', '.doctorPic img', (function(_this) {
          return function(event) {
            var doctorPic, id;
            doctorPic = $(event.currentTarget);
            id = doctorPic.attr('id');
            return $(doctorInfo({
              id: id
            })).dialog({
              title: '医生信息',
              modal: true,
              width: 300,
              height: 250,
              resizable: false
            });
          };
        })(this));
        doctorPicIndex = 1;
        return changeDotImg = window.setInterval((function(_this) {
          return function() {
            var marginLeft;
            if (doctorUrlPanel.length === 0) {
              window.clearInterval(changeDotImg);
            }
            doctorPicIndex++;
            marginLeft = (doctorPicIndex - 1) * 115;
            doctorUrlPanel.find('.doctorPic').first().css('margin-left', '-' + marginLeft + 'px');
            if (doctorPicIndex === 3) {
              return doctorPicIndex = 0;
            }
          };
        })(this), '2000');
      };

      return mpContaniter;

    })();
  });

}).call(this);
