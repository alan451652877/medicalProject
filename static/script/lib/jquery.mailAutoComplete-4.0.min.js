/*!
** 时隔两年再写此交互插件，看看变化与进步都有哪些
** by zhangxinxu(.com) jquery.mailAutoComplete-4.0.js
** 邮件地址自定义下拉
*/
(function(a){a.fn.mailAutoComplete=function(e){var g={className:"emailist",email:["qq.com","gmail.com","126.com","163.com","hotmail.com","yahoo.com","yahoo.com.cn","live.com","sohu.com","sina.com"],zIndex:11};var i=a.extend({},g,e||{});var c=typeof window.screenX==="number",b="visibility";var f={up:38,down:40,enter:13,esc:27,tab:9};var h=function(k){var m="",j=k.value.split("@"),l=[];a.each(i.email,function(o,n){if(j.length!==2||j[1]===""||n.indexOf(j[1].toLowerCase())===0){l.push(n)}});a.each(l,function(o,n){m=m+"<li"+(k.indexSelected===o?' class="on"':"")+">"+j[0]+"@"+n+"</li>"});return m};var d=function(k,j){var l=a.trim(this.value),m="";if(l===""||(m=h(this))===""){k.css(b,"hidden")}else{j&&(this.indexSelected=-1);k.css(b,"visible").html(m)}};return a(this).each(function(){this.indexSelected=-1;var j=this;var k=a("<ul></ul>").css({position:"absolute",marginTop:j.offsetHeight,minWidth:j.offsetWidth-2,visibility:"hidden",zIndex:i.zIndex}).addClass(i.className).bind("click",function(m){var l=m&&m.target;if(l&&l.tagName.toLowerCase()==="li"){a(j).val(l.innerHTML).trigger("input");a(this).css(b,"hidden")}});a(this).before(k);if(!window.XMLHttpRequest){k.width(j.offsetWidth-2)}c?a(this).bind("input",function(){d.call(this,k,true)}):j.attachEvent("onpropertychange",function(l){if(l.propertyName!=="value"){return}d.call(j,k,true)});a(document).bind({click:function(n){var m=n&&n.target,l="";if(m==j&&j.value&&(l=h(j,i.email))){k.css(b,"visible").html(l)}else{if(m!=k.get(0)&&m.parentNode!=k.get(0)){k.css(b,"hidden")}}},keydown:function(m){var l=k.find("li");if(k.css(b)==="visible"){switch(m.keyCode){case f.up:j.indexSelected--;if(j.indexSelected<0){j.indexSelected=-1+l.length}break;case f.down:j.indexSelected++;if(j.indexSelected>=l.length){j.indexSelected=0}break;case f.enter:m.preventDefault();l.get(j.indexSelected)&&a(j).val(l.eq(j.indexSelected).html());k.css("visibility","hidden");break;case f.tab:case f.esc:k.css("visibility","hidden");break}if(j.indexSelected!==-1){k.html(h(j))}}}})})}})(jQuery);